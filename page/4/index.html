<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.100.0"><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css integrity=sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk crossorigin=anonymous><link rel=stylesheet href=/css/code_tango.css><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js integrity=sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo crossorigin=anonymous></script>
<script src=https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js integrity=sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI crossorigin=anonymous></script>
<link href=https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.js></script>
<link rel=apple-touch-icon sizes=180x180 href=https://www.scottyob.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://www.scottyob.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://www.scottyob.com/favicon-16x16.png><link rel=manifest href=https://www.scottyob.com/site.webmanifest><link rel=mask-icon href=https://www.scottyob.com/safari-pinned-tab.svg color><meta name=msapplication-TileColor content><meta name=theme-color content><title>Home | Scott O'Brien</title><style>@media(min-width:992px){.container{max-width:1442px}}body{background-color:#fff;background-color:#fff;color:#888;font-size:.66em;font-family:lucida grande,Verdana,Arial,Sans-Serif;line-height:1.4;margin:0;padding:0}.header{margin:4em 0}@media(min-width:768px){#sidebar{text-align:right}}#sidebar{text-transform:lowercase}#sidebar h2{font-family:lucida grande,Verdana,Arial,Sans-Serif;font-size:1.2em;text-transform:uppercase;margin:0;padding:.5em 0 .4em}#sidebar ul{list-style-type:none;margin:0;padding:0}#sidebar li:before{content:"\00BB  "}a{color:#ff7010;text-decoration:none}h1{font-size 3.2em;line-height:1em}h2{font-size:1.4em;margin-top:10px}h1,h2,h3,h4,h5{font-family:trebuchet ms,lucida grande,Verdana,Arial,Sans-Serif;font-weight:700;line-height:normal}small{font-size:1em;line-height:1.5em;background-color:inherit;color:#888}h2.pagetitle{background-color:#f0f0f0;color:inherit;padding:.5em 0 .4em .2em;margin:0 0 2em}#content{color:#484848}.leftnav{float:left;margin:0 1em}.rightnav{float:right}.snap-to-fit{clear:both;visibility:hidden}.navigation{margin:0 0 1.6em;padding:0 0 1px;font-family:lucida grande,Arial,Verdana,Sans-Serif;font-size:1.2em}.post{margin:0 0 3em}.post+.post .post__title{padding:.2em 0 0;border-top:1px solid #888}.entry{width:100%;font-size:1.2em;margin:1em 0 0;overflow:auto}blockquote{margin:1.6em 2.8em 0 1.4em;padding:0 0 0 2em;border-left:.6em solid #ddd}#footer{clear:both;margin:4em 0 1em;padding:.2em 0 0;border-top:1px solid #888;font-family:lucida grande,Arial,Verdana,Sans-Serif}</style></head><body><div id=navbar-top class=d-md-none><nav class="navbar navbar-expand-lg navbar-light bg-light"><a class=navbar-brand href=/>Posts</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNavAltMarkup aria-controls=navbarNavAltMarkup aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNavAltMarkup><div class=navbar-nav><a class="nav-item nav-link" href=/page/bucketlist/>The Bucket List</a>
<a class="nav-item nav-link" href=/page/about/>About Me</a>
<a class="nav-item nav-link" href=/recipes/>Recipes</a></div></div></nav></div><div class=container id=container><div class=row><div class="col-md-9 offset-md-3"><div class=header><h1><a href=/>Scott O'Brien</a></h1><small>Projects, Ramblings and Resources of my (online) life</small></div></div></div><div class=row><div id=content class=col-md-9><div class=navigation><div class=leftnav>« <a href=/page/3/>Later Posts</a></div><div class=snap-to-fit></div></div><div class=post><h2 class=post__title><a href=https://www.scottyob.com/2014/02/24/finding-overlaps-in-address-space/>Finding overlaps in address space</a></h2><small>2014-02-24 06:05:36 +0000 UTC</small><div class=entry><p>We have an interesting problem at my workplace, we have an MPLS VPN design for separation of security zones (e.g., staff from students.) and we don’t have MPLS support on our edge. With a L3 to the edge design though this means that while every edge switch has its own address space (per VRF), it also has a /30 uplink (once again, per VRF) back to the PE device.</p><p>While this (rightly or wrongly decided) slightly more complicated design in itself isn’t a problem, I’ve been working on programatically putting all of this data into an IPAM (IP Address Management) solution. Doing this from the devices themselves (as apposed to a spreadsheet where it was previously kept) has provided the best way moving forward, so good in fact, that my IPAM started throwing exceptions when duplicate IP addresses and overlapping spaces were attempted to be added in the system.</p><p>The following Python script uses my <a href=https://github.com/scottyob/pyiosdevice onclick="_gaq.push(['_trackEvent','outbound-article','http://github.com'])">Cisco IOS python library</a> to be able to identify IP address overlaps from a bunch of my saved device configs.</p><p>It works by the following:</p><ol><li>Adds all L3 interfaces addresses and secondary addresses to a list</li><li>Sorts list such that larger subnets are at the front, smaller (/32’s and the such) are at the back of the list.</li><li>Walks through each subnet, if the network addresses is not in the routing table, add it in, if it is, add it to a list of colliding subnets.</li><li>With the list of colliding subnets (subnets that have been multiply defined, or are of overlapping size):<ol><li>If they are /30’s and there are only two places of definition, skip</li><li>if the subnet values are not equal OR an address appears twice in the subnet.  Print it out as a colliding address (space)</li></ol></li></ol><p>You can find the <a href=https://gist.github.com/scottyob/9182695 onclick="_gaq.push(['_trackEvent','outbound-article','http://gist.github.com'])">script as a ghist here</a> (note:  This assumes the devices have been picked and loaded as a Picked list of IOSDevice’s)</p></div></div><div class=post><h2 class=post__title><a href=https://www.scottyob.com/2014/01/29/automating-vlan-changes-for-esxi-switchports-in-cisco-ios/>Automating VLAN changes for ESXi Switchports in Cisco IOS.</a></h2><small>2014-01-29 10:51:35 +0000 UTC</small><div class=entry><p><a href=/img/old/2014/01/product_bulletin_cisco_catalyst_6509_enhanced_vertical_chassis-1.jpg onclick="_gaq.push(['_trackEvent','outbound-article','http://www.scottyob.com'])"><img class="size-full wp-image-370 alignleft" alt=6500 src=/img/old/2014/01/product_bulletin_cisco_catalyst_6509_enhanced_vertical_chassis-1.jpg width=242 height=302></a></p><p>At the organisation I’m currently working for, we recently experienced <a href=http://www.vspecialist.co.uk/do-my-esxi-hosts-have-the-same-vlans/ onclick="_gaq.push(['_trackEvent','outbound-article','http://www.vspecialist.co.uk'])">what appears to be a common issue</a>, VLAN’s trunked down to ESXi nodes were inconsistent.</p><p>In our DC, we’re still running the old school Cisco Catalyst switches.  If we were running a fabric, or Nexus switches <a href=http://blog.alwaysthenetwork.com/tutorials/nexus-port-profiles/ onclick="_gaq.push(['_trackEvent','outbound-article','http://blog.alwaysthenetwork.com'])">we could put port profiles to action</a> or if we lucky enough to have some equipment running Junos &lt;3 we could be <a href=http://packetpushers.net/junos-configuration-groups/ onclick="_gaq.push(['_trackEvent','outbound-article','http://packetpushers.net'])">using apply-groups for this</a>.</p><p>Being stuck with 6500’s in the DC as our L2 platform (and a VSS for the L3 MPLS PE) this is a quick little hack job to automate configuration changes across switchports in Cisco IOS based on dynamically finding ports that are matching an interface description.</p><p>In our DC, we have a bunch of switches (defined at the top of this script) and all our switchports that go to ESXi switchports that should have this template applied are matched on the interface description containing ‘ESXHOST’</p><p>This relies on the <a href=https://github.com/knipknap/exscript/wiki/Python-API-Tutorial onclick="_gaq.push(['_trackEvent','outbound-article','http://github.com'])">python EXScript module</a></p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:green># This script is used for updating the VLANs that are trunked down to ESX boxes.</span>
</span></span><span style=display:flex><span><span style=color:green>#  It works by logging in to each switch in the DC then looking at the interfaces that have &#39;ESXHOST&#39;</span>
</span></span><span style=display:flex><span><span style=color:green>#  in the description.  For each of those switchports, it will run the &#39;alter&#39; commands</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>from</span> Exscript.Account <span style=color:#00f>import</span> Account
</span></span><span style=display:flex><span><span style=color:#00f>from</span> Exscript.protocols <span style=color:#00f>import</span> SSH2
</span></span><span style=display:flex><span><span style=color:#00f>import</span> argparse
</span></span><span style=display:flex><span><span style=color:#00f>import</span> getopt
</span></span><span style=display:flex><span><span style=color:#00f>import</span> getpass
</span></span><span style=display:flex><span><span style=color:#00f>import</span> sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>#A list of the switches to interigate.  These are the switches that have ESXi hosts in them</span>
</span></span><span style=display:flex><span>SWITCHES = [
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;10.0.0.2&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;10.0.0.3&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;10.0.0.4&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;10.0.0.5&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;10.0.0.7&#39;</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>#Commands to execute for every switchport</span>
</span></span><span style=display:flex><span>vlan_commands = <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>  switchport trunk allowed vlan add 5,10,15,20-25,30,40,50
</span></span></span><span style=display:flex><span><span style=color:#a31515>  switchport trunk allowed vlan add 60,69,70,100-1000
</span></span></span><span style=display:flex><span><span style=color:#a31515>&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>def</span> query_yes_no(question, default=<span style=color:#a31515>&#34;yes&#34;</span>):
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#34;&#34;&#34;Ask a yes/no question via raw_input() and return their answer.
</span></span></span><span style=display:flex><span><span style=color:#a31515>
</span></span></span><span style=display:flex><span><span style=color:#a31515>    &#34;question&#34; is a string that is presented to the user.
</span></span></span><span style=display:flex><span><span style=color:#a31515>    &#34;default&#34; is the presumed answer if the user just hits &amp;lt;Enter&amp;gt;.
</span></span></span><span style=display:flex><span><span style=color:#a31515>        It must be &#34;yes&#34; (the default), &#34;no&#34; or None (meaning
</span></span></span><span style=display:flex><span><span style=color:#a31515>        an answer is required of the user).
</span></span></span><span style=display:flex><span><span style=color:#a31515>
</span></span></span><span style=display:flex><span><span style=color:#a31515>    The &#34;answer&#34; return value is one of &#34;yes&#34; or &#34;no&#34;.
</span></span></span><span style=display:flex><span><span style=color:#a31515>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    valid = {<span style=color:#a31515>&#34;yes&#34;</span>:<span style=color:#00f>True</span>,   <span style=color:#a31515>&#34;y&#34;</span>:<span style=color:#00f>True</span>,  <span style=color:#a31515>&#34;ye&#34;</span>:<span style=color:#00f>True</span>,
</span></span><span style=display:flex><span>             <span style=color:#a31515>&#34;no&#34;</span>:<span style=color:#00f>False</span>,     <span style=color:#a31515>&#34;n&#34;</span>:<span style=color:#00f>False</span>}
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> default == <span style=color:#00f>None</span>:
</span></span><span style=display:flex><span>        prompt = <span style=color:#a31515>&#34; [y/n] &#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>elif</span> default == <span style=color:#a31515>&#34;yes&#34;</span>:
</span></span><span style=display:flex><span>        prompt = <span style=color:#a31515>&#34; [Y/n] &#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>elif</span> default == <span style=color:#a31515>&#34;no&#34;</span>:
</span></span><span style=display:flex><span>        prompt = <span style=color:#a31515>&#34; [y/N] &#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#00f>raise</span> ValueError(<span style=color:#a31515>&#34;invalid default answer: &#39;</span><span style=color:#a31515>%s</span><span style=color:#a31515>&#39;&#34;</span> % default)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> <span style=color:#00f>True</span>:
</span></span><span style=display:flex><span>        sys.stdout.write(question + prompt)
</span></span><span style=display:flex><span>        choice = raw_input().lower()
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> default <span style=color:#00f>is</span> <span style=color:#00f>not</span> <span style=color:#00f>None</span> <span style=color:#00f>and</span> choice == <span style=color:#a31515>&#39;&#39;</span>:
</span></span><span style=display:flex><span>            <span style=color:#00f>return</span> valid[default]
</span></span><span style=display:flex><span>        <span style=color:#00f>elif</span> choice <span style=color:#00f>in</span> valid:
</span></span><span style=display:flex><span>            <span style=color:#00f>return</span> valid[choice]
</span></span><span style=display:flex><span>        <span style=color:#00f>else</span>:
</span></span><span style=display:flex><span>            sys.stdout.write(<span style=color:#a31515>&#34;Please respond with &#39;yes&#39; or &#39;no&#39; &#34;</span>\
</span></span><span style=display:flex><span>                             <span style=color:#a31515>&#34;(or &#39;y&#39; or &#39;n&#39;).</span><span style=color:#a31515>\n</span><span style=color:#a31515>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>def</span> returnInterfacesFromShowDescription(text):
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>    Returns a LIST of interfaces from the output of &#39;show interface desc&#39; from a cisco device
</span></span></span><span style=display:flex><span><span style=color:#a31515>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> [ x.split()[0] <span style=color:#00f>for</span> x <span style=color:#00f>in</span> text.split(<span style=color:#a31515>&#34;</span><span style=color:#a31515>\n</span><span style=color:#a31515>&#34;</span>) ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>def</span> genUpdateConfigForInterfaces(config, interfaces):
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>    Takes in a configuration block to run, a list of interfaces and generates the appropriate int range commands with the
</span></span></span><span style=display:flex><span><span style=color:#a31515>    config block after
</span></span></span><span style=display:flex><span><span style=color:#a31515>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    updateConfig = <span style=color:#a31515>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>while</span> len(interfaces) &amp;gt; 0:
</span></span><span style=display:flex><span>        updateConfig += <span style=color:#a31515>&#34;int range &#34;</span> + <span style=color:#a31515>&#34;,&#34;</span>.join(interfaces[:5])
</span></span><span style=display:flex><span>        interfaces = interfaces[5:]
</span></span><span style=display:flex><span>        updateConfig += <span style=color:#a31515>&#34;</span><span style=color:#a31515>\n</span><span style=color:#a31515>  </span><span style=color:#a31515>%s</span><span style=color:#a31515>\n</span><span style=color:#a31515>&#34;</span> % config.strip()
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> updateConfig
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>def</span> updateSwitchportsWithDescription(switch, description, username, password, commands):
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a31515>    Function is used to log into a switch, find all switchports that CONTAINS the description
</span></span></span><span style=display:flex><span><span style=color:#a31515>    with each of the said switchports, it will then execute the given commands.
</span></span></span><span style=display:flex><span><span style=color:#a31515>
</span></span></span><span style=display:flex><span><span style=color:#a31515>    switch:  Device to log into
</span></span></span><span style=display:flex><span><span style=color:#a31515>    description:  Search string to try and find in the switchport description
</span></span></span><span style=display:flex><span><span style=color:#a31515>    username:  Username to log into the switch with
</span></span></span><span style=display:flex><span><span style=color:#a31515>    password:  The password to log into the switch with
</span></span></span><span style=display:flex><span><span style=color:#a31515>    commands:  A list of commands that should be executed
</span></span></span><span style=display:flex><span><span style=color:#a31515>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print <span style=color:#a31515>&#34;Working with switch: </span><span style=color:#a31515>%s</span><span style=color:#a31515>&#34;</span> % switch
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green>#establish a SSH connection to the host</span>
</span></span><span style=display:flex><span>    conn = SSH2()
</span></span><span style=display:flex><span>    account = Account(username, password)
</span></span><span style=display:flex><span>    conn.connect(switch)
</span></span><span style=display:flex><span>    conn.login(account)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green>#Do some pre-setup</span>
</span></span><span style=display:flex><span>    conn.execute(<span style=color:#a31515>&#39;&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green>#Make sure we&#39;re in super user mode</span>
</span></span><span style=display:flex><span>    conn.execute(<span style=color:#a31515>&#39;enable&#39;</span>)
</span></span><span style=display:flex><span>    conn.execute(<span style=color:#a31515>&#39;terminal length 0&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green>#find all ports that have ESXHOST (or whatever is set in description) in the description</span>
</span></span><span style=display:flex><span>    conn.execute(<span style=color:#a31515>&#39;show int desc | i </span><span style=color:#a31515>%s</span><span style=color:#a31515>&#39;</span> % description)
</span></span><span style=display:flex><span>    ports = conn.response.strip()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print <span style=color:#a31515>&#34;Ports are:&#34;</span>
</span></span><span style=display:flex><span>    print ports
</span></span><span style=display:flex><span>    portsList = returnInterfacesFromShowDescription(ports)[1:-1]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green>#go into config mode and get ready to run the update commands</span>
</span></span><span style=display:flex><span>    <span style=color:green>#Generate a list of the update commands that should be ran</span>
</span></span><span style=display:flex><span>    updateCommands = genUpdateConfigForInterfaces(commands, portsList).split(<span style=color:#a31515>&#34;</span><span style=color:#a31515>\n</span><span style=color:#a31515>&#34;</span>)
</span></span><span style=display:flex><span>    conn.execute(<span style=color:#a31515>&#39;conf t&#39;</span>)
</span></span><span style=display:flex><span>    print conn.response.strip()
</span></span><span style=display:flex><span>    print <span style=color:#a31515>&#34;! About to execute the following commands.&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>for</span> line <span style=color:#00f>in</span> updateCommands:
</span></span><span style=display:flex><span>        print <span style=color:#a31515>&#34;! &#34;</span> + line
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> query_yes_no(<span style=color:#a31515>&#39;Execute Commands?&#39;</span>, default=<span style=color:#a31515>&#34;no&#34;</span>):
</span></span><span style=display:flex><span>        <span style=color:green>#Run the set of commands given</span>
</span></span><span style=display:flex><span>        <span style=color:#00f>for</span> command <span style=color:#00f>in</span> updateCommands:
</span></span><span style=display:flex><span>            conn.execute(command)
</span></span><span style=display:flex><span>            print conn.response
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:green>#Exit out of config mode</span>
</span></span><span style=display:flex><span>        conn.execute(<span style=color:#a31515>&#34;exit&#34;</span>)
</span></span><span style=display:flex><span>        conn.execute(<span style=color:#a31515>&#34;exit&#34;</span>)
</span></span><span style=display:flex><span>        print conn.response
</span></span><span style=display:flex><span>        print
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>if</span> __name__ == <span style=color:#a31515>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    parser = argparse.ArgumentParser(description=<span style=color:#a31515>&#34;DC ESX VLAN Utility&#34;</span>)
</span></span><span style=display:flex><span>    parser.add_argument(<span style=color:#a31515>&#39;--user&#39;</span>, help=<span style=color:#a31515>&#39;The username that should be used to log into the switches with&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    args = parser.parse_args()
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> args.user:
</span></span><span style=display:flex><span>        username = args.user
</span></span><span style=display:flex><span>    <span style=color:#00f>else</span>:
</span></span><span style=display:flex><span>        username = getpass.getuser()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    password = getpass.getpass()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># Generate a list of commands</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>for</span> switch <span style=color:#00f>in</span> SWITCHES:
</span></span><span style=display:flex><span>        updateSwitchportsWithDescription(switch, <span style=color:#a31515>&#39;ESXHOST&#39;</span>, username, password, vlan_commands)
</span></span></code></pre></td></tr></table></div></div></div></div><div class=post><h2 class=post__title><a href=https://www.scottyob.com/2013/12/18/throttling-guest-internet-on-apple-airport-extreme/>throttling guest internet on Apple Airport Extreme</a></h2><small>2013-12-18 13:09:03 +0000 UTC</small><div class=entry><p>I’ve been happily running my Apple Airport Extreme as m home router for the past few years (since my debian router died, and I’ve been too lazy to replace it).  One of the cool features was the ability to create a guest network (SSID) to access the internet without being able to access your trusted network.  One feature I wanted was the ability to throttle the speed guests can access the internet at.  While I couldn’t do this with the Airport Extreme alone, Add a Juniper SRX100 into the mix that the awesome <a href=http://cooperlees.com onclick="_gaq.push(['_trackEvent','outbound-article','http://cooperlees.com'])">Cooper Lees</a> gave me into the mix and problem solved.</p><p><a href=/img/old/2013/12/apple-airport-extreme-base-station_1.jpg onclick="_gaq.push(['_trackEvent','outbound-article','http://www.scottyob.com'])"><img class="aligncenter size-full wp-image-362" alt=apple-airport-extreme-base-station_1 src=/img/old/2013/12/apple-airport-extreme-base-station_1.jpg width=600 height=450></a></p><div id=attachment_357 style=width:499px class="wp-caption aligncenter"><a href=/img/old/2013/12/photo-1.jpg onclick="_gaq.push(['_trackEvent','outbound-article','http://www.scottyob.com'])"><img aria-describedby=caption-attachment-357 class=wp-image-357 alt="SRX100, signed by the #1 Juniper Engineer" src=/img/old/2013/12/photo-1.jpg width=489 height=367></a><p id=caption-attachment-357 class=wp-caption-text>SRX100, signed by the #1 Juniper Engineer</p></div><p><a href=/img/old/2013/12/AirPort-Utility1.jpg onclick="_gaq.push(['_trackEvent','outbound-article','http://www.scottyob.com'])"><img class="aligncenter size-full wp-image-353" alt="AirPort Utility" src=/img/old/2013/12/AirPort-Utility1.jpg width=697 height=667></a></p><p><a href=/img/old/2013/12/AirPort-Utility-2.jpg onclick="_gaq.push(['_trackEvent','outbound-article','http://www.scottyob.com'])"><img class="aligncenter size-full wp-image-356" alt="AirPort Utility-2" src=/img/old/2013/12/AirPort-Utility-2.jpg width=580 height=581></a></p><p>In not so many words, performing these actions will do a number of things.  The gig ethernet switch on the back of the airport will be bridged with the WAN port.  Any traffic from your normal SSID(s) and switchports will be sent out the WAN port <em>untagged.</em>  Traffic from your guest network will be sent .1q tagged with vlan 1003.</p><p>I popped this into fe-0/0/1 on my SRX100 and the following config works the magic.</p><div class=highlight><div style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>    fe-0/0/1 {
</span></span><span style=display:flex><span>        unit 0 {
</span></span><span style=display:flex><span>            family ethernet-switching {
</span></span><span style=display:flex><span>                port-mode trunk;
</span></span><span style=display:flex><span>                vlan {
</span></span><span style=display:flex><span>                    members vlan-guest;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                native-vlan-id 3;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    vlan {
</span></span><span style=display:flex><span>        unit 0 {
</span></span><span style=display:flex><span>            family inet {
</span></span><span style=display:flex><span>                address 10.0.1.1/24;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        unit 1003 {
</span></span><span style=display:flex><span>            family inet {
</span></span><span style=display:flex><span>                filter {
</span></span><span style=display:flex><span>                    input limit_guest_upload;
</span></span><span style=display:flex><span>                    output limit_guest_download;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                address 10.0.2.1/24;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[system services]
</span></span><span style=display:flex><span>        dhcp {
</span></span><span style=display:flex><span>            pool 10.0.1.0/24 {
</span></span><span style=display:flex><span>                address-range low 10.0.1.2 high 10.0.1.199;
</span></span><span style=display:flex><span>                router {
</span></span><span style=display:flex><span>                    10.0.1.1;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            pool 10.0.2.0/24 {
</span></span><span style=display:flex><span>                address-range low 10.0.2.2 high 10.0.2.254;
</span></span><span style=display:flex><span>                router {
</span></span><span style=display:flex><span>                    10.0.2.1;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            propagate-settings fe-0/0/0.0;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[security]
</span></span><span style=display:flex><span>    nat {
</span></span><span style=display:flex><span>        source {
</span></span><span style=display:flex><span>            rule-set private-to-internet {
</span></span><span style=display:flex><span>                from zone [ guest trust ];
</span></span><span style=display:flex><span>                to zone untrust;
</span></span><span style=display:flex><span>                rule source-nat-rule {
</span></span><span style=display:flex><span>                    match {
</span></span><span style=display:flex><span>                        source-address 0.0.0.0/0;
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                    then {
</span></span><span style=display:flex><span>                        source-nat {
</span></span><span style=display:flex><span>                            interface;
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    policies {
</span></span><span style=display:flex><span>        from-zone trust to-zone untrust {
</span></span><span style=display:flex><span>            policy trust-to-untrust {
</span></span><span style=display:flex><span>                match {
</span></span><span style=display:flex><span>                    source-address any;
</span></span><span style=display:flex><span>                    destination-address any;
</span></span><span style=display:flex><span>                    application any;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                then {
</span></span><span style=display:flex><span>                    permit;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        from-zone guest to-zone untrust {
</span></span><span style=display:flex><span>            policy guest-to-internet {
</span></span><span style=display:flex><span>                description &#34;Allows guest access to internet&#34;;
</span></span><span style=display:flex><span>                match {
</span></span><span style=display:flex><span>                    source-address any;
</span></span><span style=display:flex><span>                    destination-address any;
</span></span><span style=display:flex><span>                    application any;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                then {
</span></span><span style=display:flex><span>                    permit;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[security zones]
</span></span><span style=display:flex><span>        security-zone guest {
</span></span><span style=display:flex><span>            host-inbound-traffic {
</span></span><span style=display:flex><span>                system-services {
</span></span><span style=display:flex><span>                    dns;
</span></span><span style=display:flex><span>                    ping;
</span></span><span style=display:flex><span>                    traceroute;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            interfaces {
</span></span><span style=display:flex><span>                vlan.1003;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>firewall {
</span></span><span style=display:flex><span>    policer guest-shaping {
</span></span><span style=display:flex><span>        if-exceeding {
</span></span><span style=display:flex><span>            bandwidth-limit 500k;
</span></span><span style=display:flex><span>            burst-size-limit 300k;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        then discard;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    filter limit_guest_download {
</span></span><span style=display:flex><span>        term guest-shaping {
</span></span><span style=display:flex><span>            then {
</span></span><span style=display:flex><span>                policer guest-shaping;
</span></span><span style=display:flex><span>                accept;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    filter limit_guest_upload {
</span></span><span style=display:flex><span>        term guest-shaping {
</span></span><span style=display:flex><span>            then {
</span></span><span style=display:flex><span>                policer guest-shaping;
</span></span><span style=display:flex><span>                accept;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>vlans {
</span></span><span style=display:flex><span>    vlan-guest {
</span></span><span style=display:flex><span>        vlan-id 1003;
</span></span><span style=display:flex><span>        l3-interface vlan.1003;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    vlan-trust {
</span></span><span style=display:flex><span>        vlan-id 3;
</span></span><span style=display:flex><span>        l3-interface vlan.0;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>And there you have it! A really simple way of limiting the bandwidth of guest users on your network using the power of Junos with an Airport Extreme!</p><p> </p><p style=text-align:center><a href=/img/old/2013/12/photo-2.png onclick="_gaq.push(['_trackEvent','outbound-article','http://www.scottyob.com'])"><img class="aligncenter wp-image-364" alt="Throttled Speed" src=/img/old/2013/12/photo-2.png width=384 height=576></a></p></div></div><div class=post><h2 class=post__title><a href=https://www.scottyob.com/2013/04/09/what-is-anycast/>What is Anycast?</a></h2><small>2013-04-09 12:15:31 +0000 UTC</small><div class=entry><p>I’ve never found a really simple video on what exactly Anycast is with a basic examples when exploring the concepts.  I decided to lab it up and figured this might help some of you starting out with the concepts.  Any comments feel free to let me know!</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/YM_b_YmTRBA style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>Config Attached for IOS lab <a title=HERE href=/img/old/2013/04/IOU_WEB_ANYCAST.zip onclick="_gaq.push(['_trackEvent','download','/img/old/2013/04/IOU_WEB_ANYCAST.zip'])">HERE.</a></p></div></div><div class=navigation><div class=rightnav><a href=/page/5/>Earlier Posts</a> »</div><div class=snap-to-fit></div></div><div id=footer>Made with <a href=https://gohugo.io/>Hugo</a>. Theme half-milk inspired by <a href=http://thortz.com/skimmed-milk/>skimmed-milk</a></div></div><div id=sidebar class="col-md-3 order-md-first d-none d-md-block"><h2>Other Pages</h2><ul><li><a href=/page/bucketlist/>The Bucket List</a></li><li><a href=/page/about/>About Me</a></li><li><a href=/recipes/>Recipes</a></li></ul></div></div></div></body></html>